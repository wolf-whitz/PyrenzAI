name: Count Lines of Code

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  count_lines:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Count lines of code in .ts and .tsx files
        run: |
          # Navigate to the src directory
          cd src
          
          # Initialize a total line counter
          total_lines=0
          
          # Find all .ts and .tsx files, count their lines, and sum it
          for file in $(find . -type f \( -iname \*.ts -o -iname \*.tsx \)); do
            lines_in_file=$(wc -l < "$file")
            echo "$file: $lines_in_file lines" >> lines.txt
            total_lines=$((total_lines + lines_in_file))
          done
          
          # Output total lines
          echo "Total lines of code: $total_lines" >> lines.txt

      - name: Upload lines.txt as artifact
        uses: actions/upload-artifact@v2
        with:
          name: lines-of-code
          path: src/lines.txt
